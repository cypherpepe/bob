"use strict";(self.webpackChunkBOB_docs=self.webpackChunkBOB_docs||[]).push([[4814],{1260:(e,c,t)=>{t.r(c),t.d(c,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>d,metadata:()=>i,toc:()=>a});var r=t(4848),n=t(8453);const d={},l="BtcMarketPlace",i={id:"contracts/src/src/swap/Btc_Marketplace.sol/contract.BtcMarketPlace",title:"BtcMarketPlace",description:"Git Source",source:"@site/docs/contracts/src/src/swap/Btc_Marketplace.sol/contract.BtcMarketPlace.md",sourceDirName:"contracts/src/src/swap/Btc_Marketplace.sol",slug:"/contracts/src/src/swap/Btc_Marketplace.sol/contract.BtcMarketPlace",permalink:"/docs/contracts/src/src/swap/Btc_Marketplace.sol/contract.BtcMarketPlace",draft:!1,unlisted:!1,editUrl:"https://github.com/bob-collective/bob/tree/master/docs/docs/contracts/src/src/swap/Btc_Marketplace.sol/contract.BtcMarketPlace.md",tags:[],version:"current",frontMatter:{},sidebar:"contractSidebar",previous:{title:"Bridge",permalink:"/docs/contracts/src/src/swap/Bridge.sol/contract.Bridge"},next:{title:"Faucet",permalink:"/docs/contracts/src/src/swap/Faucet.sol/contract.Faucet"}},s={},a=[{value:"State Variables",id:"state-variables",level:2},{value:"btcBuyOrders",id:"btcbuyorders",level:3},{value:"acceptedBtcBuyOrders",id:"acceptedbtcbuyorders",level:3},{value:"btcSellOrders",id:"btcsellorders",level:3},{value:"acceptedBtcSellOrders",id:"acceptedbtcsellorders",level:3},{value:"nextOrderId",id:"nextorderid",level:3},{value:"REQUEST_EXPIRATION_SECONDS",id:"request_expiration_seconds",level:3},{value:"testLightRelay",id:"testlightrelay",level:3},{value:"txProofDifficultyFactor",id:"txproofdifficultyfactor",level:3},{value:"Functions",id:"functions",level:2},{value:"constructor",id:"constructor",level:3},{value:"setRelay",id:"setrelay",level:3},{value:"placeBtcSellOrder",id:"placebtcsellorder",level:3},{value:"acceptBtcSellOrder",id:"acceptbtcsellorder",level:3},{value:"proofBtcSellOrder",id:"proofbtcsellorder",level:3},{value:"withdrawBtcSellOrder",id:"withdrawbtcsellorder",level:3},{value:"cancelAcceptedBtcSellOrder",id:"cancelacceptedbtcsellorder",level:3},{value:"placeBtcBuyOrder",id:"placebtcbuyorder",level:3},{value:"acceptBtcBuyOrder",id:"acceptbtcbuyorder",level:3},{value:"proofBtcBuyOrder",id:"proofbtcbuyorder",level:3},{value:"withdrawBtcBuyOrder",id:"withdrawbtcbuyorder",level:3},{value:"cancelAcceptedBtcBuyOrder",id:"cancelacceptedbtcbuyorder",level:3},{value:"getOpenBtcSellOrders",id:"getopenbtcsellorders",level:3},{value:"getOpenAcceptedBtcSellOrders",id:"getopenacceptedbtcsellorders",level:3},{value:"getOpenBtcBuyOrders",id:"getopenbtcbuyorders",level:3},{value:"getOpenAcceptedBtcBuyOrders",id:"getopenacceptedbtcbuyorders",level:3},{value:"_checkBitcoinTxOutput",id:"_checkbitcointxoutput",level:3},{value:"Events",id:"events",level:2},{value:"placeBtcSellOrderEvent",id:"placebtcsellorderevent",level:3},{value:"acceptBtcSellOrderEvent",id:"acceptbtcsellorderevent",level:3},{value:"proofBtcSellOrderEvent",id:"proofbtcsellorderevent",level:3},{value:"withdrawBtcSellOrderEvent",id:"withdrawbtcsellorderevent",level:3},{value:"cancelAcceptedBtcSellOrderEvent",id:"cancelacceptedbtcsellorderevent",level:3},{value:"placeBtcBuyOrderEvent",id:"placebtcbuyorderevent",level:3},{value:"acceptBtcBuyOrderEvent",id:"acceptbtcbuyorderevent",level:3},{value:"proofBtcBuyOrderEvent",id:"proofbtcbuyorderevent",level:3},{value:"withdrawBtcBuyOrderEvent",id:"withdrawbtcbuyorderevent",level:3},{value:"cancelAcceptedBtcBuyOrderEvent",id:"cancelacceptedbtcbuyorderevent",level:3},{value:"Structs",id:"structs",level:2},{value:"BtcSellOrder",id:"btcsellorder",level:3},{value:"AcceptedBtcSellOrder",id:"acceptedbtcsellorder",level:3},{value:"BtcBuyOrder",id:"btcbuyorder",level:3},{value:"AcceptedBtcBuyOrder",id:"acceptedbtcbuyorder",level:3},{value:"BitcoinAddress",id:"bitcoinaddress",level:3},{value:"TransactionProof",id:"transactionproof",level:3}];function o(e){const c={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.header,{children:(0,r.jsx)(c.h1,{id:"btcmarketplace",children:"BtcMarketPlace"})}),"\n",(0,r.jsx)(c.p,{children:(0,r.jsx)(c.a,{href:"https://github.com/bob-collective/bob/blob/master/src/swap/Btc_Marketplace.sol",children:"Git Source"})}),"\n",(0,r.jsxs)(c.p,{children:[(0,r.jsx)(c.strong,{children:"Inherits:"}),"\nERC2771Recipient"]}),"\n",(0,r.jsx)(c.h2,{id:"state-variables",children:"State Variables"}),"\n",(0,r.jsx)(c.h3,{id:"btcbuyorders",children:"btcBuyOrders"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"mapping(uint256 => BtcBuyOrder) public btcBuyOrders;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"acceptedbtcbuyorders",children:"acceptedBtcBuyOrders"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"mapping(uint256 => AcceptedBtcBuyOrder) public acceptedBtcBuyOrders;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"btcsellorders",children:"btcSellOrders"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"mapping(uint256 => BtcSellOrder) public btcSellOrders;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"acceptedbtcsellorders",children:"acceptedBtcSellOrders"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"mapping(uint256 => AcceptedBtcSellOrder) public acceptedBtcSellOrders;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"nextorderid",children:"nextOrderId"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"uint256 nextOrderId;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"request_expiration_seconds",children:"REQUEST_EXPIRATION_SECONDS"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"uint256 public constant REQUEST_EXPIRATION_SECONDS = 6 hours;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"testlightrelay",children:"testLightRelay"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"TestLightRelay internal testLightRelay;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"txproofdifficultyfactor",children:"txProofDifficultyFactor"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"uint256 internal txProofDifficultyFactor;\n"})}),"\n",(0,r.jsx)(c.h2,{id:"functions",children:"Functions"}),"\n",(0,r.jsx)(c.h3,{id:"constructor",children:"constructor"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"constructor(TestLightRelay _relay, address erc2771Forwarder);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"setrelay",children:"setRelay"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function setRelay(TestLightRelay _relay) internal;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"placebtcsellorder",children:"placeBtcSellOrder"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function placeBtcSellOrder(uint256 amountBtc, address buyingToken, uint256 buyAmount) public;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"acceptbtcsellorder",children:"acceptBtcSellOrder"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function acceptBtcSellOrder(uint256 id, BitcoinAddress calldata bitcoinAddress, uint256 amountBtc)\n    public\n    returns (uint256);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"proofbtcsellorder",children:"proofBtcSellOrder"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function proofBtcSellOrder(uint256 id, BitcoinTx.Info calldata transaction, BitcoinTx.Proof calldata proof) public;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"withdrawbtcsellorder",children:"withdrawBtcSellOrder"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function withdrawBtcSellOrder(uint256 id) public;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"cancelacceptedbtcsellorder",children:"cancelAcceptedBtcSellOrder"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function cancelAcceptedBtcSellOrder(uint256 id) public;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"placebtcbuyorder",children:"placeBtcBuyOrder"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function placeBtcBuyOrder(\n    uint256 amountBtc,\n    BitcoinAddress calldata bitcoinAddress,\n    address sellingToken,\n    uint256 saleAmount\n) public;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"acceptbtcbuyorder",children:"acceptBtcBuyOrder"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function acceptBtcBuyOrder(uint256 id, uint256 amountBtc) public returns (uint256);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"proofbtcbuyorder",children:"proofBtcBuyOrder"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function proofBtcBuyOrder(uint256 id, BitcoinTx.Info calldata transaction, BitcoinTx.Proof calldata proof) public;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"withdrawbtcbuyorder",children:"withdrawBtcBuyOrder"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function withdrawBtcBuyOrder(uint256 id) public;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"cancelacceptedbtcbuyorder",children:"cancelAcceptedBtcBuyOrder"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function cancelAcceptedBtcBuyOrder(uint256 id) public;\n"})}),"\n",(0,r.jsx)(c.h3,{id:"getopenbtcsellorders",children:"getOpenBtcSellOrders"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function getOpenBtcSellOrders() external view returns (BtcSellOrder[] memory, uint256[] memory);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"getopenacceptedbtcsellorders",children:"getOpenAcceptedBtcSellOrders"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function getOpenAcceptedBtcSellOrders() external view returns (AcceptedBtcSellOrder[] memory, uint256[] memory);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"getopenbtcbuyorders",children:"getOpenBtcBuyOrders"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function getOpenBtcBuyOrders() external view returns (BtcBuyOrder[] memory, uint256[] memory);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"getopenacceptedbtcbuyorders",children:"getOpenAcceptedBtcBuyOrders"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function getOpenAcceptedBtcBuyOrders() external view returns (AcceptedBtcBuyOrder[] memory, uint256[] memory);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"_checkbitcointxoutput",children:"_checkBitcoinTxOutput"}),"\n",(0,r.jsx)(c.p,{children:"Checks output script pubkey (recipient address) and amount.\nReverts if transaction amount is lower or bitcoin address is not found."}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"function _checkBitcoinTxOutput(\n    uint256 expectedBtcAmount,\n    BitcoinAddress storage bitcoinAddress,\n    BitcoinTx.Info calldata transaction\n) private view;\n"})}),"\n",(0,r.jsx)(c.p,{children:(0,r.jsx)(c.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(c.table,{children:[(0,r.jsx)(c.thead,{children:(0,r.jsxs)(c.tr,{children:[(0,r.jsx)(c.th,{children:"Name"}),(0,r.jsx)(c.th,{children:"Type"}),(0,r.jsx)(c.th,{children:"Description"})]})}),(0,r.jsxs)(c.tbody,{children:[(0,r.jsxs)(c.tr,{children:[(0,r.jsx)(c.td,{children:(0,r.jsx)(c.code,{children:"expectedBtcAmount"})}),(0,r.jsx)(c.td,{children:(0,r.jsx)(c.code,{children:"uint256"})}),(0,r.jsx)(c.td,{children:"BTC amount requested in order."})]}),(0,r.jsxs)(c.tr,{children:[(0,r.jsx)(c.td,{children:(0,r.jsx)(c.code,{children:"bitcoinAddress"})}),(0,r.jsx)(c.td,{children:(0,r.jsx)(c.code,{children:"BitcoinAddress"})}),(0,r.jsx)(c.td,{children:"Recipient's bitcoin address."})]}),(0,r.jsxs)(c.tr,{children:[(0,r.jsx)(c.td,{children:(0,r.jsx)(c.code,{children:"transaction"})}),(0,r.jsx)(c.td,{children:(0,r.jsx)(c.code,{children:"BitcoinTx.Info"})}),(0,r.jsx)(c.td,{children:"Transaction fulfilling the order."})]})]})]}),"\n",(0,r.jsx)(c.h2,{id:"events",children:"Events"}),"\n",(0,r.jsx)(c.h3,{id:"placebtcsellorderevent",children:"placeBtcSellOrderEvent"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"event placeBtcSellOrderEvent(uint256 indexed orderId, uint256 amountBtc, address buyingToken, uint256 buyAmount);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"acceptbtcsellorderevent",children:"acceptBtcSellOrderEvent"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"event acceptBtcSellOrderEvent(\n    uint256 indexed id,\n    uint256 indexed acceptId,\n    BitcoinAddress bitcoinAddress,\n    uint256 amountBtc,\n    uint256 ercAmount,\n    address ercToken\n);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"proofbtcsellorderevent",children:"proofBtcSellOrderEvent"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"event proofBtcSellOrderEvent(uint256 id);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"withdrawbtcsellorderevent",children:"withdrawBtcSellOrderEvent"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"event withdrawBtcSellOrderEvent(uint256 id);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"cancelacceptedbtcsellorderevent",children:"cancelAcceptedBtcSellOrderEvent"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"event cancelAcceptedBtcSellOrderEvent(uint256 id);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"placebtcbuyorderevent",children:"placeBtcBuyOrderEvent"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"event placeBtcBuyOrderEvent(uint256 amountBtc, BitcoinAddress bitcoinAddress, address sellingToken, uint256 saleAmount);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"acceptbtcbuyorderevent",children:"acceptBtcBuyOrderEvent"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"event acceptBtcBuyOrderEvent(\n    uint256 indexed orderId, uint256 indexed acceptId, uint256 amountBtc, uint256 ercAmount, address ercToken\n);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"proofbtcbuyorderevent",children:"proofBtcBuyOrderEvent"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"event proofBtcBuyOrderEvent(uint256 id);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"withdrawbtcbuyorderevent",children:"withdrawBtcBuyOrderEvent"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"event withdrawBtcBuyOrderEvent(uint256 id);\n"})}),"\n",(0,r.jsx)(c.h3,{id:"cancelacceptedbtcbuyorderevent",children:"cancelAcceptedBtcBuyOrderEvent"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"event cancelAcceptedBtcBuyOrderEvent(uint256 id);\n"})}),"\n",(0,r.jsx)(c.h2,{id:"structs",children:"Structs"}),"\n",(0,r.jsx)(c.h3,{id:"btcsellorder",children:"BtcSellOrder"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"struct BtcSellOrder {\n    uint256 amountBtc;\n    address askingToken;\n    uint256 askingAmount;\n    address requester;\n}\n"})}),"\n",(0,r.jsx)(c.h3,{id:"acceptedbtcsellorder",children:"AcceptedBtcSellOrder"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"struct AcceptedBtcSellOrder {\n    uint256 orderId;\n    BitcoinAddress bitcoinAddress;\n    uint256 amountBtc;\n    address ercToken;\n    uint256 ercAmount;\n    address requester;\n    address accepter;\n    uint256 acceptTime;\n}\n"})}),"\n",(0,r.jsx)(c.h3,{id:"btcbuyorder",children:"BtcBuyOrder"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"struct BtcBuyOrder {\n    uint256 amountBtc;\n    BitcoinAddress bitcoinAddress;\n    address offeringToken;\n    uint256 offeringAmount;\n    address requester;\n}\n"})}),"\n",(0,r.jsx)(c.h3,{id:"acceptedbtcbuyorder",children:"AcceptedBtcBuyOrder"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"struct AcceptedBtcBuyOrder {\n    uint256 orderId;\n    uint256 amountBtc;\n    address ercToken;\n    uint256 ercAmount;\n    address requester;\n    address accepter;\n    uint256 acceptTime;\n}\n"})}),"\n",(0,r.jsx)(c.h3,{id:"bitcoinaddress",children:"BitcoinAddress"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"struct BitcoinAddress {\n    bytes scriptPubKey;\n}\n"})}),"\n",(0,r.jsx)(c.h3,{id:"transactionproof",children:"TransactionProof"}),"\n",(0,r.jsx)(c.pre,{children:(0,r.jsx)(c.code,{className:"language-solidity",children:"struct TransactionProof {\n    uint256 dummy;\n}\n"})})]})}function u(e={}){const{wrapper:c}={...(0,n.R)(),...e.components};return c?(0,r.jsx)(c,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453:(e,c,t)=>{t.d(c,{R:()=>l,x:()=>i});var r=t(6540);const n={},d=r.createContext(n);function l(e){const c=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(c):{...c,...e}}),[c,e])}function i(e){let c;return c=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),r.createElement(d.Provider,{value:c},e.children)}}}]);