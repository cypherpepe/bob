"use strict";(self.webpackChunkBOB_docs=self.webpackChunkBOB_docs||[]).push([[1480],{5330:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>t,default:()=>o,frontMatter:()=>i,metadata:()=>c,toc:()=>h});var r=n(4848),d=n(8453);const i={},t="FullRelay",c={id:"contracts/src/src/relay/FullRelay.sol/contract.FullRelay",title:"FullRelay",description:"Git Source",source:"@site/docs/contracts/src/src/relay/FullRelay.sol/contract.FullRelay.md",sourceDirName:"contracts/src/src/relay/FullRelay.sol",slug:"/contracts/src/src/relay/FullRelay.sol/contract.FullRelay",permalink:"/docs/contracts/src/src/relay/FullRelay.sol/contract.FullRelay",draft:!1,unlisted:!1,editUrl:"https://github.com/bob-collective/bob/tree/master/docs/docs/contracts/src/src/relay/FullRelay.sol/contract.FullRelay.md",tags:[],version:"current",frontMatter:{},sidebar:"contractSidebar",previous:{title:"OracleTokenPaymaster",permalink:"/docs/contracts/src/src/paymasters/OracleTokenPaymaster.sol/contract.OracleTokenPaymaster"},next:{title:"IFullRelay",permalink:"/docs/contracts/src/src/relay/FullRelayInterfaces.sol/interface.IFullRelay"}},l={},h=[{value:"State Variables",id:"state-variables",level:2},{value:"HEIGHT_INTERVAL",id:"height_interval",level:3},{value:"relayGenesis",id:"relaygenesis",level:3},{value:"bestKnownDigest",id:"bestknowndigest",level:3},{value:"lastReorgCommonAncestor",id:"lastreorgcommonancestor",level:3},{value:"previousBlock",id:"previousblock",level:3},{value:"blockHeight",id:"blockheight",level:3},{value:"currentEpochDiff",id:"currentepochdiff",level:3},{value:"prevEpochDiff",id:"prevepochdiff",level:3},{value:"Functions",id:"functions",level:2},{value:"constructor",id:"constructor",level:3},{value:"isHeaderValidLength",id:"isheadervalidlength",level:3},{value:"isHeaderChainValidLength",id:"isheaderchainvalidlength",level:3},{value:"isMerkleArrayValidLength",id:"ismerklearrayvalidlength",level:3},{value:"getCurrentEpochDifficulty",id:"getcurrentepochdifficulty",level:3},{value:"getPrevEpochDifficulty",id:"getprevepochdifficulty",level:3},{value:"getRelayGenesis",id:"getrelaygenesis",level:3},{value:"getBestKnownDigest",id:"getbestknowndigest",level:3},{value:"getLastReorgCommonAncestor",id:"getlastreorgcommonancestor",level:3},{value:"findHeight",id:"findheight",level:3},{value:"findAncestor",id:"findancestor",level:3},{value:"isAncestor",id:"isancestor",level:3},{value:"addHeaders",id:"addheaders",level:3},{value:"addHeadersWithRetarget",id:"addheaderswithretarget",level:3},{value:"markNewHeaviest",id:"marknewheaviest",level:3},{value:"_addHeaders",id:"_addheaders",level:3},{value:"_addHeadersWithRetarget",id:"_addheaderswithretarget",level:3},{value:"_findHeight",id:"_findheight",level:3},{value:"_findAncestor",id:"_findancestor",level:3},{value:"_isAncestor",id:"_isancestor",level:3},{value:"_markNewHeaviest",id:"_marknewheaviest",level:3},{value:"_isMostRecentAncestor",id:"_ismostrecentancestor",level:3},{value:"_heaviestFromAncestor",id:"_heaviestfromancestor",level:3}];function x(e){const s={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"fullrelay",children:"FullRelay"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.a,{href:"https://github.com/bob-collective/bob/blob/master/src/relay/FullRelay.sol",children:"Git Source"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Inherits:"}),"\n",(0,r.jsx)(s.a,{href:"/docs/contracts/src/src/relay/FullRelayInterfaces.sol/interface.IFullRelay",children:"IFullRelay"})]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Author:"}),"\nDistributed Crafts (",(0,r.jsx)(s.a,{href:"https://www.gobob.xyz/",children:"https://www.gobob.xyz/"}),")\nForked from ",(0,r.jsx)(s.a,{href:"https://github.com/summa-tx/relays",children:"https://github.com/summa-tx/relays"}),"\nChanges made:"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"dependency changes"}),"\n"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"changed summa-tx/bitcoin-spv to keep-network/bitcoin-spv-sol"}),"\n",(0,r.jsx)(s.li,{children:"remove SafeMath"}),"\n"]}),"\n",(0,r.jsxs)(s.ol,{start:"2",children:["\n",(0,r.jsx)(s.li,{children:"test changes"}),"\n"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"fixed some tests that were written incorrectly in the summa repo"}),"\n",(0,r.jsx)(s.li,{children:"ported Truffle javascript tests to Foundry solidity"}),"\n",(0,r.jsx)(s.li,{children:"new tests added"}),"\n"]}),"\n",(0,r.jsxs)(s.ol,{start:"3",children:["\n",(0,r.jsx)(s.li,{children:"solidity compiler version upgraded to 0.8.17"}),"\n",(0,r.jsx)(s.li,{children:"OnDemandSPV was gutted and only the verification part was kept"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"state-variables",children:"State Variables"}),"\n",(0,r.jsx)(s.h3,{id:"height_interval",children:"HEIGHT_INTERVAL"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"uint32 public constant HEIGHT_INTERVAL = 4;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"relaygenesis",children:"relayGenesis"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"bytes32 internal relayGenesis;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"bestknowndigest",children:"bestKnownDigest"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"bytes32 internal bestKnownDigest;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"lastreorgcommonancestor",children:"lastReorgCommonAncestor"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"bytes32 internal lastReorgCommonAncestor;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"previousblock",children:"previousBlock"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"mapping(bytes32 => bytes32) internal previousBlock;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"blockheight",children:"blockHeight"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"mapping(bytes32 => uint256) internal blockHeight;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"currentepochdiff",children:"currentEpochDiff"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"uint256 internal currentEpochDiff;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"prevepochdiff",children:"prevEpochDiff"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"uint256 internal prevEpochDiff;\n"})}),"\n",(0,r.jsx)(s.h2,{id:"functions",children:"Functions"}),"\n",(0,r.jsx)(s.h3,{id:"constructor",children:"constructor"}),"\n",(0,r.jsx)(s.p,{children:"Gives a starting point for the relay"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"We don't check this AT ALL really. Don't use relays with bad genesis"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"constructor(bytes memory _genesisHeader, uint256 _height, bytes32 _periodStart);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_genesisHeader"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"The starting header"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_height"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"uint256"})}),(0,r.jsx)(s.td,{children:"The starting height"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_periodStart"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The hash of the first header in the genesis epoch"})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"isheadervalidlength",children:"isHeaderValidLength"}),"\n",(0,r.jsx)(s.p,{children:"Checks whether the header is 80 bytes long"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function isHeaderValidLength(bytes memory _header) internal pure returns (bool);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_header"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"The header for which the length is checked"})]})})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsx)(s.td,{children:"True if the header's length is 80 bytes, and false otherwise"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"isheaderchainvalidlength",children:"isHeaderChainValidLength"}),"\n",(0,r.jsx)(s.p,{children:"Checks whether the header chain's length is a multiple of 80 bytes"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function isHeaderChainValidLength(bytes memory _headerChain) internal pure returns (bool);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_headerChain"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"The header chain for which the length is checked"})]})})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsx)(s.td,{children:"True if the header chain's length is a multiple of 80 bytes, and false otherwise"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"ismerklearrayvalidlength",children:"isMerkleArrayValidLength"}),"\n",(0,r.jsx)(s.p,{children:"Checks whether the merkle proof array's length is a multiple of 32 bytes"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function isMerkleArrayValidLength(bytes memory _merkleProofArray) internal pure returns (bool);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_merkleProofArray"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"The merkle proof array for which the length is checked"})]})})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsx)(s.td,{children:"True if the merkle proof array's length is a multiple of 32 bytes, and false otherwise"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"getcurrentepochdifficulty",children:"getCurrentEpochDifficulty"}),"\n",(0,r.jsx)(s.p,{children:"Getter for currentEpochDiff"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"This is updated when a new heavist header has a new diff"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function getCurrentEpochDifficulty() external view returns (uint256);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"uint256"})}),(0,r.jsx)(s.td,{children:"The difficulty of the bestKnownDigest"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"getprevepochdifficulty",children:"getPrevEpochDifficulty"}),"\n",(0,r.jsx)(s.p,{children:"Getter for prevEpochDiff"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"This is updated when a difficulty change is accepted"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function getPrevEpochDifficulty() external view returns (uint256);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"uint256"})}),(0,r.jsx)(s.td,{children:"The difficulty of the previous epoch"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"getrelaygenesis",children:"getRelayGenesis"}),"\n",(0,r.jsx)(s.p,{children:"Getter for relayGenesis"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"This is an initialization parameter"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function getRelayGenesis() public view returns (bytes32);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The hash of the first block of the relay"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"getbestknowndigest",children:"getBestKnownDigest"}),"\n",(0,r.jsx)(s.p,{children:"Getter for bestKnownDigest"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"This updated only by calling markNewHeaviest"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function getBestKnownDigest() public view returns (bytes32);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The hash of the best marked chain tip"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"getlastreorgcommonancestor",children:"getLastReorgCommonAncestor"}),"\n",(0,r.jsx)(s.p,{children:"Getter for relayGenesis"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"This is updated only by calling markNewHeaviest"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function getLastReorgCommonAncestor() public view returns (bytes32);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The hash of the shared ancestor of the most recent fork"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"findheight",children:"findHeight"}),"\n",(0,r.jsx)(s.p,{children:"Finds the height of a header by its digest"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"Will fail if the header is unknown"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function findHeight(bytes32 _digest) external view returns (uint256);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_digest"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The header digest to search for"})]})})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"uint256"})}),(0,r.jsx)(s.td,{children:"The height of the header, or error if unknown"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"findancestor",children:"findAncestor"}),"\n",(0,r.jsx)(s.p,{children:"Finds an ancestor for a block by its digest"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"Will fail if the header is unknown"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function findAncestor(bytes32 _digest, uint256 _offset) external view returns (bytes32);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_digest"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The header digest to search for"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_offset"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"uint256"})}),(0,r.jsx)(s.td,{})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The height of the header, or error if unknown"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"isancestor",children:"isAncestor"}),"\n",(0,r.jsx)(s.p,{children:"Checks if a digest is an ancestor of the current one"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"Limit the amount of lookups (and thus gas usage) with _limit"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function isAncestor(bytes32 _ancestor, bytes32 _descendant, uint256 _limit) external view returns (bool);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_ancestor"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The prospective ancestor"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_descendant"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The descendant to check"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_limit"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"uint256"})}),(0,r.jsx)(s.td,{children:"The maximum number of blocks to check"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsx)(s.td,{children:"true if ancestor is at most limit blocks lower than descendant, otherwise false"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"addheaders",children:"addHeaders"}),"\n",(0,r.jsx)(s.p,{children:"Adds headers to storage after validating"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"We check integrity and consistency of the header chain"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function addHeaders(bytes calldata _anchor, bytes calldata _headers) external returns (bool);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_anchor"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"The header immediately preceeding the new chain"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_headers"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"A tightly-packed list of 80-byte Bitcoin headers"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsx)(s.td,{children:"True if successfully written, error otherwise"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"addheaderswithretarget",children:"addHeadersWithRetarget"}),"\n",(0,r.jsx)(s.p,{children:"Adds headers to storage, performs additional validation of retarget"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"Checks the retarget, the heights, and the linkage"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function addHeadersWithRetarget(\n    bytes calldata _oldPeriodStartHeader,\n    bytes calldata _oldPeriodEndHeader,\n    bytes calldata _headers\n) external returns (bool);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_oldPeriodStartHeader"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"The first header in the difficulty period being closed"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_oldPeriodEndHeader"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"The last header in the difficulty period being closed"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_headers"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"A tightly-packed list of 80-byte Bitcoin headers"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsx)(s.td,{children:"True if successfully written, error otherwise"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"marknewheaviest",children:"markNewHeaviest"}),"\n",(0,r.jsx)(s.p,{children:"Gives a starting point for the relay"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"We don't check this AT ALL really. Don't use relays with bad genesis"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function markNewHeaviest(bytes32 _ancestor, bytes calldata _currentBest, bytes calldata _newBest, uint256 _limit)\n    external\n    returns (bool);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_ancestor"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The digest of the most recent common ancestor"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_currentBest"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"The 80-byte header referenced by bestKnownDigest"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_newBest"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"The 80-byte header to mark as the new best"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_limit"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"uint256"})}),(0,r.jsx)(s.td,{children:"Limit the amount of traversal of the chain"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsx)(s.td,{children:"True if successfully updates bestKnownDigest, error otherwise"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"_addheaders",children:"_addHeaders"}),"\n",(0,r.jsx)(s.p,{children:"Adds headers to storage after validating"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"We check integrity and consistency of the header chain"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function _addHeaders(bytes memory _anchor, bytes memory _headers, bool _internal) internal returns (bool);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_anchor"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"The header immediately preceeding the new chain"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_headers"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"A tightly-packed list of new 80-byte Bitcoin headers to record"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_internal"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsx)(s.td,{children:"True if called internally from addHeadersWithRetarget, false otherwise"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsx)(s.td,{children:"True if successfully written, error otherwise"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"_addheaderswithretarget",children:"_addHeadersWithRetarget"}),"\n",(0,r.jsx)(s.p,{children:"Extract basic info"}),"\n",(0,r.jsx)(s.p,{children:"Adds headers to storage, performs additional validation of retarget"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"Checks the retarget, the heights, and the linkage"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function _addHeadersWithRetarget(bytes memory _oldStart, bytes memory _oldEnd, bytes memory _headers)\n    internal\n    returns (bool);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_oldStart"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"The first header in the difficulty period being closed"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_oldEnd"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"The last header in the difficulty period being closed"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_headers"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"A tightly-packed list of 80-byte Bitcoin headers"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsx)(s.td,{children:"True if successfully written, error otherwise"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"_findheight",children:"_findHeight"}),"\n",(0,r.jsx)(s.p,{children:"Finds the height of a header by its digest"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"Will fail if the header is unknown"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function _findHeight(bytes32 _digest) internal view returns (uint256);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_digest"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The header digest to search for"})]})})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"uint256"})}),(0,r.jsx)(s.td,{children:"The height of the header"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"_findancestor",children:"_findAncestor"}),"\n",(0,r.jsx)(s.p,{children:"Finds an ancestor for a block by its digest"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"Will fail if the header is unknown"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function _findAncestor(bytes32 _digest, uint256 _offset) internal view returns (bytes32);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_digest"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The header digest to search for"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_offset"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"uint256"})}),(0,r.jsx)(s.td,{})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The height of the header, or error if unknown"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"_isancestor",children:"_isAncestor"}),"\n",(0,r.jsx)(s.p,{children:"Checks if a digest is an ancestor of the current one"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"Limit the amount of lookups (and thus gas usage) with _limit"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function _isAncestor(bytes32 _ancestor, bytes32 _descendant, uint256 _limit) internal view virtual returns (bool);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_ancestor"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The prospective ancestor"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_descendant"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The descendant to check"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_limit"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"uint256"})}),(0,r.jsx)(s.td,{children:"The maximum number of blocks to check"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsx)(s.td,{children:"true if ancestor is at most limit blocks lower than descendant, otherwise false"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"_marknewheaviest",children:"_markNewHeaviest"}),"\n",(0,r.jsx)(s.p,{children:"Marks the new best-known chain tip"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function _markNewHeaviest(bytes32 _ancestor, bytes memory _current, bytes memory _new, uint256 _limit)\n    internal\n    returns (bool);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_ancestor"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The digest of the most recent common ancestor"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_current"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"The 80-byte header referenced by bestKnownDigest"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_new"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"The 80-byte header to mark as the new best"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_limit"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"uint256"})}),(0,r.jsx)(s.td,{children:"Limit the amount of traversal of the chain"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsx)(s.td,{children:"True if successfully updates bestKnownDigest, error otherwise"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"_ismostrecentancestor",children:"_isMostRecentAncestor"}),"\n",(0,r.jsx)(s.p,{children:"Checks if a digest is an ancestor of the current one"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"Limit the amount of lookups (and thus gas usage) with _limit"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function _isMostRecentAncestor(bytes32 _ancestor, bytes32 _left, bytes32 _right, uint256 _limit)\n    internal\n    view\n    returns (bool);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_ancestor"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The prospective shared ancestor"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_left"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"A chain tip"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_right"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"A chain tip"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_limit"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"uint256"})}),(0,r.jsx)(s.td,{children:"The maximum number of blocks to check"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsx)(s.td,{children:"true if it is the most recent common ancestor within _limit, false otherwise"})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"_heaviestfromancestor",children:"_heaviestFromAncestor"}),"\n",(0,r.jsx)(s.p,{children:"Decides which header is heaviest from the ancestor"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"Does not support reorgs above 2017 blocks (:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-solidity",children:"function _heaviestFromAncestor(bytes32 _ancestor, bytes memory _left, bytes memory _right)\n    internal\n    view\n    returns (bytes32);\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Parameters"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_ancestor"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"The prospective shared ancestor"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_left"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"A chain tip"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"_right"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes"})}),(0,r.jsx)(s.td,{children:"A chain tip"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Returns"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<none>"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bytes32"})}),(0,r.jsx)(s.td,{children:"true if it is the most recent common ancestor within _limit, false otherwise"})]})})]})]})}function o(e={}){const{wrapper:s}={...(0,d.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(x,{...e})}):x(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>c});var r=n(6540);const d={},i=r.createContext(d);function t(e){const s=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:t(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);